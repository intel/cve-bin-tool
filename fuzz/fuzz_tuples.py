import atheris

with atheris.instrument_imports():
    import sys
    import csv

    from cve_bin_tool.input_engine import parse_data


def TestParseData(data):
    try:
        # data should be a fuzzy product tuple
        parse_data({"vendor","product","version"}, data)

    except SystemExit:
        # force return on SystemExit since those are mostly InsufficientArgs
        return

atheris_libprotobuff_mutator.Setup(sys.argv, TestParseData, proto="product_tuple.proto")
atheris.Fuzz()
