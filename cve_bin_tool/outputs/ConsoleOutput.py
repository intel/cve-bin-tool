import csv

from cve_bin_tool.outputs.Output import Output


class ConsoleOutput(Output):
    def __init__(self, filename, modules, logger):
        super().__init__(filename, "console")
        self.logger = logger
        self.modules = modules

    def create_output(self):
        writer = csv.writer(self.filename)
        writer.writerow(["Module Name", "Version", "CVE Number", "Severity"])

        for modulename, versions in self.modules.items():
            for version, cve_list in versions.items():
                for cve_number, cve_severity in cve_list.items():
                    row = [modulename, version, cve_number, cve_severity]
                    writer.writerow(row)
