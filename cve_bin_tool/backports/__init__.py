from typing import Dict

import distro

from cve_bin_tool.cve_scanner import CVEData
from cve_bin_tool.log import LOGGER
from cve_bin_tool.output_engine.util import ProductInfo

from .debian_backports import DebianCVETracker

DEBIAN_DISTROS = ["debian", "ubuntu"]


class BackportReport:
    def __init__(
        self,
        all_cve_data: Dict[ProductInfo, CVEData],
    ):
        self.all_cve_data = all_cve_data

    def check_backport(self):
        if distro.id() in DEBIAN_DISTROS:
            debian_tracker = DebianCVETracker()
            debian_tracker.cve_info(self.all_cve_data)
        else:
            LOGGER.info(
                f"CVE Binary Tool doesn't support Backport Fix Utility for {distro.id().capitalize()} at the moment."
            )
