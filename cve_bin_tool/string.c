#include <Python.h>

static PyObject* StringLib_string(PyObject* self, PyObject* args) {
    char *path;
    if (!PyArg_ParseTuple(args, "s", &path)) {
        return NULL;
    }
    char c[1000];
    FILE *fptr;

    if ((fptr = fopen(path, "r")) == NULL)
    {
        printf("Error! opening file");
        // Program exits if file pointer returns NULL.
        exit(1);         
    }

    // reads text until newline 
    fscanf(fptr,"%[^\n]", c);

    printf("Data from the file:\n%s", c);
    fclose(fptr); 
    return Py_BuildValue("s", c);
};

// module's function table
static PyMethodDef StringLib_FunctionsTable[] = {  
    {
        "string", // name exposed to Python
        StringLib_string, // C wrapper function
        METH_VARARGS, // received variable args (but really just 1)
        "Read file" // documentation
    }, {
        NULL, NULL, 0, NULL
    }
};

// modules definition
static struct PyModuleDef string = {  
    PyModuleDef_HEAD_INIT,
    "string",     // name of module exposed to Python
    "Python wrapper for string C extension library.", // module documentation
    -1,
    StringLib_FunctionsTable
};

PyMODINIT_FUNC PyInit_demo(void) {  
    return PyModule_Create(&string);
}
