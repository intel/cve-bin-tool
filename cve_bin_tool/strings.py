#!/usr/bin/python3

"""
These are the customized strings and file classes, by doing this
the tool is able to support other operating systems like Windows
and MacOS.
"""

import sys
import string

try:
    import cve_bin_tool.pstring as pstring
except ImportError:
    pstring = None


class Strings(object):
    def __init__(self, filename=""):
        self.filename = filename
        self.output = ""
        self.printable = set(string.printable)

    def parse(self):
        # Use c extention if available
        if pstring is not None:
            return pstring.string(self.filename)
        else:
            return self.parse_3()

    def parse_3(self):
        with open(self.filename, "r", encoding="ascii", errors="surrogateescape") as f:
            self.output = "".join(filter(lambda x: x in self.printable, f.read()))
        return self.output


if __name__ == "__main__":
    s = Strings(sys.argv[1])
    s.parse()
