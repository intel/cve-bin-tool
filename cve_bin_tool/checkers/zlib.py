#!/usr/bin/python3

"""
CVE checker for zlib
--------
References:
http://www.cvedetails.com/vulnerability-list/vendor_id-72/product_id-1820/GNU-Zlib.html
https://zlib.net/ChangeLog.txt

RSS feed: http://www.cvedetails.com/vulnerability-feed.php?vendor_id=72&product_id=1820&version_id=&orderby=2&cvssscoremin=0
"""
from . import Checker
from string import printable


class ZlibChecker(Checker):
    CONTAINS_PATTERNS = [
        r"Copyright 1995-2017 Jean-loup Gailly and Mark Adler",
        r"Copyright 1995-2017 Mark Adler",
        r"too many length or distance symbols",
    ]
    FILENAME_PATTERNS = [
        r"libz.so.",
        r"libz.so.[01]",
        r"libz.so.([01]+\.[0-9]+\.[0-9])",
    ]
    VERSION_PATTERNS = [
        r"deflate ([01]+\.[0-9]+\.[0-9]+) ",
        r"inflate ([01]+\.[0-9]+\.[0-9]+) ",
        r"libz.so.([01]+\.[0-9]+\.[0-9]+)",
    ]
    VENDOR_PRODUCT = [("gnu", "zlib")]
