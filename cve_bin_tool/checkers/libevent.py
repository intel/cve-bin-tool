# Copyright (C) 2021 Intel Corporation
# SPDX-License-Identifier: GPL-3.0-or-later

"""
CVE checker for libevent

https://www.cvedetails.com/product/32303/Libevent-Project-Libevent.html?vendor_id=15590

"""
from cve_bin_tool.checkers import Checker


class LibeventChecker(Checker):
    CONTAINS_PATTERNS = [
        r"Error from libevent when adding timer event",
        r"Error from libevent when adding event for DNS server",
    ]
    FILENAME_PATTERNS = [r"libevent.so"]
    VERSION_PATTERNS = [
        r"([0-9]\.[0-9]\.[0-9]{1,2})-stable",
    ]
    VENDOR_PRODUCT = [("libevent project", "libevent")]
