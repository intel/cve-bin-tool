# Copyright (C) 2023 Intel Corporation
# SPDX-License-Identifier: GPL-3.0-or-later

"""

CVE checker for Libevent

https://www.cvedetails.com/vulnerability-list/vendor_id-15590/product_id-32303/Libevent-Project-Libevent.html

"""

from cve_bin_tool.checkers import Checker


class LibeventChecker(Checker):
    CONTAINS_PATTERNS = [
        # r"Added a signal to event base %p with signals already added to event_base %p.  Only one can have signals at a time with the %s backend.  The base with the most recently added signal or the most recent event_base_loop() call gets preference; do not rely on this behavior in future Libevent versions.",
        # r"Error from libevent when adding event"
        # r"Error from libevent when adding event for DNS server",
        # r"Error from libevent when adding timer event",
    ]

    FILENAME_PATTERNS = [
        r"libevent.so",
    ]

    VERSION_PATTERNS = [
        r"([0-9]\.[0-9]\.[0-9]+)-stable",
        r"event-([0-9]\.[0-9]\.[0-9]+)",
    ]

    VENDOR_PRODUCT = [("libevent project", "libevent")]
