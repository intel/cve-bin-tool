# Copyright (C) 2023 Intel Corporation
# SPDX-License-Identifier: GPL-3.0-or-later

"""

CVE checker for Docker
https://www.cvedetails.com/product/28125/Docker-Docker.html?vendor_id=13534

"""

from cve_bin_tool.checkers import Checker


class DockerChecker(Checker):
    CONTAINS_PATTERNS: list[str] = []

    FILENAME_PATTERNS = [r"docker", r"dockerd", r"gcc"]

    VERSION_PATTERNS = [
        r"docker-([0-9]+\.[0-9]\.[0-9]+)",
        # r"([0-9]+\.[0-9][0-9]\.[0-9]+)\r?\n[a-zA-Z,: \[]*\r?\n[\./]*[dD][oO][cC][kK][eE][rR]",
        # # r"([0-9]+\.[0-9]+\.[0-9]+)-stable",
        # r"docker version: ([0-9]+\.[0-9]+\.)",
        r"([0-9]+\.[0-9]+\.[0-9]+)\r?\ndocker",
        r"([0-9]\.[0-9]+\.[0-9])\nUnknown\nEBMLVoid",
        r"gcc-([0-9]+\.[0-9]\.[0-9]+)",
    ]

    VENDOR_PRODUCT = [("docker", "docker")]
