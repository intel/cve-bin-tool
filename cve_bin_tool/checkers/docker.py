# Copyright (C) 2023 Intel Corporation
# SPDX-License-Identifier: GPL-3.0-or-later

"""

CVE checker for docker
https://www.cvedetails.com/product/28125/Docker-Docker.html?vendor_id=13534

"""

from cve_bin_tool.checkers import Checker


class DockerChecker(Checker):
    CONTAINS_PATTERNS = [
        r"RequestSizeBuckets must be providedRequested key is not in the keyringRetrying predefined pool search: %vServer request count by HTTP methodSkipping key change as agent is nilStatus: Downloaded newer image for TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHATotal number of HTTP requests made.Unable to find cpu cgroup in mountsUnable to get loopback backing fileUnsupported value for param "
        r"SupplementalGroupsStrategyOptionsToken is the opaque bearer token.Unsupported compression format"
        r"tracebackancestorstrailers_not_endedtransaction failedtruncated sequencetwoheadrightarrow;"
    ]

    FILENAME_PATTERNS = [
        r"docker",
        r"dockerd",
    ]

    VERSION_PATTERNS = [
        r"([0-9]+\.[0-9]+\.[0-9]+)\r?\ndocker",
        r"([0-9]\.[0-9])\nUnknown\nEBMLVoid",  # This string may be brittle to changes in string ordering
    ]

    VENDOR_PRODUCT = [("docker", "docker")]
