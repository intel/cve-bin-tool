""" CVE Checkers """
__all__ = [
    "bluez",
    "cups",
    "curl",
    "expat",
    "ffmpeg",
    "gnutls",
    "hostapd",
    "icu",
    "kerberos",
    "libdb",
    "libgcrypt",
    "libjpeg",
    "libnss",
    "libtiff",
    "lighttpd",
    "ncurses",
    "nginx",
    "node",
    "nessus",
    "openssh",
    "openssl",
    "openswan",
    "png",
    "postgresql",
    "rsyslog",
    "sqlite",
    "strongswan",
    "syslogng",
    "systemd",
    "varnish",
    "wireshark",
    "xerces",
    "xml2",
    "zlib",
    "python",
    "bzip2",
    "gstreamer",
    "binutils",
]

from cve_bin_tool.util import regex_find


class Checker:
    CONTAINS = []
    REGEX = []
    VENDOR_PACKAGE = []

    def guess_contains(self, lines):
        for line in lines:
            if any(contain in line for contain in self.CONTAINS):
                return 1
        return 0

    def get_version(self, lines, filename):
        version_info = dict()
        if "bzip" in filename.lower():
            version_info["is_or_contains"] = "is"

        elif self.guess_contains(lines):
            version_info["is_or_contains"] = "contains"

        if "is_or_contains" in version_info:
            version_info["modulename"] = self.VENDOR_PACKAGE[0][1]
            version_info["version"] = regex_find(lines, *self.REGEX)

        return version_info
