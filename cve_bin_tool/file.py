#!/usr/bin/python3

"""
This is the customized file class, by doing this
the tool is able to support other operating systems like Windows
and MacOS.
"""

import string
import sys
import platform
import binascii

class File(object):

    def __init__(self, filename = ''):
        self.filename = filename
        self.output = ''
        self.os = platform.system()
        self.signature = ''
        if filename == '':
            pass
        else:
            self.signature = self.read_signature().decode('utf-8')

    def read_signature(self):
        # read signature (first 4 bytes) of the file
        with open(self.filename, 'rb') as f:
            byte = f.read(4)
            return binascii.hexlify(byte)

    def check(self):
        # make sure class has signature before check
        if self.signature == '':
            self.signature = self.read_signature().decode('utf-8')
        return self.check_linux() or self.check_windows()

    def check_linux(self):
        # by decoding we could ignore the affect caused by python version
        if sys.byteorder == 'little':
            return self.signature == '7f454c46'
        else:
            return self.signature == '457f464c'

    def check_windows(self):
        # in windows/dos, the signature of exectuable is 0x5a4d
        if sys.byteorder == 'little':
            return self.signature[:4] == '4d5a'
        else:
            return self.signature[:4] == '5a4d'
