#!/usr/bin/python3
import os
import sys

from cve_bin_tool.input_engine import InvalidCsvError
from . import cli
from .log import LOGGER


def main(argv=None):
    argv = argv or sys.argv
    if len(argv) < 2:
        LOGGER.error("Invalid Usage: csv file required")
        return -2
    flag = False
    for idx, arg in enumerate(argv):
        if arg.endswith(".csv"):
            argv[idx] = f"-i={arg}"
            flag = True
    if flag:
        return cli.main(argv)
    else:
        raise InvalidCsvError


if __name__ == "__main__":
    if os.getenv("NO_EXIT_CVE_NUM"):
        main()
    else:
        sys.exit(main())
