"""
CVE-bin-tool File tests
"""
import os
import sys
import unittest
import subprocess

from cve_bin_tool.file import File

BINARIES_PATH = os.path.join(
    os.path.abspath(os.path.dirname(__file__)), 'binaries')


class TestFile(unittest.TestCase):
    """ Tests the CVE Bin Tool Strings"""

    @classmethod
    def setUpClass(cls):
        # build binaries
        subprocess.call(["make", "clean"], cwd=BINARIES_PATH)
        subprocess.call(["make", "all"], cwd=BINARIES_PATH)
        cls.file = File()

    def _check_test(self, filename, Bool):
        """Helper function to parse a binary file and check whether
        the given string is in the parsed result"""
        self.file.filename = os.path.join(BINARIES_PATH, filename)
        self.assertEqual(self.file.check(), Bool)

    def test_curl_7_34_0_out(self):
        """file test-curl-7.34.0.out"""
        self._check_test('test-curl-7.34.0.out', True)

    def test_curl_7_34_0_source(self):
        """file test-curl-7.34.0.c"""
        self._check_test('test-curl-7.34.0.c', False)
