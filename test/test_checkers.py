#!python

import pytest
from cve_bin_tool.checkers import *


class TestCheckers:
    """Run a series of tests directly against the checkers.
    This is a companion to the tests in TestScanner."""

    def _filename_test_python(self, filename, expected_result):
        """ Helper function for testing the python checker's filename
        detection.

        FIXME: This should be generalized for all checkers """
        result = python.get_version([""], filename)
        assert result["is_or_contains"] == "is"
        assert result["modulename"] == expected_result

    @pytest.mark.parametrize(
        "filename, expected_result",
        [
            ("python3.8", "python"),
            ("python", "python"),
            # ("python3.9", "python"),
        ],
    )
    def test_filename_python(self, filename, expected_result):
        """ Test the python checker's filename detection"""
        self._filename_test_python(filename, expected_result)
